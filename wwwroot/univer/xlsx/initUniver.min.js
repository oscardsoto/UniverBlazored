export function initUniver(e){const{createUniver:t}=UniverPresets,{LocaleType:n,merge:r}=UniverCore,{defaultTheme:i}=UniverDesign,{univerAPI:o}=t({locale:n.EN_US,locales:{[n.EN_US]:r({},UniverPresetSheetsCoreEnUS,e.hasShort?UniverPresetSheetsSortEnUS:null,e.hasDataValidation?UniverPresetSheetsDataValidationEnUS:null,e.hasFilter?UniverPresetSheetsFilterEnUS:null,e.hasConditionalFormatting?UniverPresetSheetsConditionalFormattingEnUS:null,e.hasHyperLink?UniverPresetSheetsHyperLinkEnUS:null,e.hasThreadComment?UniverPresetSheetsThreadCommentEnUS:null,e.hasDrawing?UniverPresetSheetsDrawingEnUS:null,null,null)},theme:i,presets:getPresets(e),plugins:getPlugins(e)});o.createUniverSheet({name:e.newSheetName}),window.univerAPI=o,window.univerAPI.getUserService=function(){return window.univerAPI.getUserManager()._userManagerService},window.univerAPI.addEvent(window.univerAPI.Event.SheetEditEnded,(async e=>{var t={row:e.row,col:e.column,unitId:e.workbook.id,subUnitId:e.worksheet.getSheetId()};if(window.listenerNET.listeners.includes(t)){var n=e.worksheet.getRange(t.row,t.col).getValue();await window.listenerNET.net.invokeMethodAsync("OnDataChanged",t,n)}}))}function getPresets(e){var t=[];const{UniverSheetsCorePreset:n}=UniverPresetSheetsCore;if(t.push(n({container:e.idDiv})),e.hasShort){const{UniverSheetsSortPreset:e}=UniverPresetSheetsSort;t.push(e())}if(e.hasDataValidation){const{UniverSheetsDataValidationPreset:e}=UniverPresetSheetsDataValidation;t.push(e())}if(e.hasFilter){const{UniverSheetsFilterPreset:e}=UniverPresetSheetsFilter;t.push(e())}if(e.hasConditionalFormatting){const{UniverSheetsConditionalFormattingPreset:e}=UniverPresetSheetsConditionalFormatting;t.push(e())}if(e.hasHyperLink){const{UniverSheetsHyperLinkPreset:e}=UniverPresetSheetsHyperLink;t.push(e())}if(e.hasDrawing){const{UniverSheetsDrawingPreset:e}=UniverPresetSheetsDrawing;t.push(e())}if(e.hasThreadComment){const{UniverSheetsThreadCommentPreset:e}=UniverPresetSheetsThreadComment;t.push(e())}return t}function getPlugins(e){var t=[];if(e.hasCrosshair){const{UniverSheetsCrosshairHighlightPlugin:e}=UniverSheetsCrosshairHighlight;t.push(e)}if(e.hasWatermark){const{UniverWatermarkPlugin:n}=UniverWatermark;t.push([n,{textWatermarkSettings:{content:e.watermarkLabel}}])}return t}export function getAndExecuteMethod(e,t){for(var n=null,r=0;r<e.length;r++)if(0!=r){if("function"!=typeof n[e[r].methodName])return console.error(`Method ${r}: ${e[r].methodName} does not exist on Univer API`),console.error(n),{res:!1};n=0==e[r].args.length?n[e[r].methodName]():n[e[r].methodName](...e[r].args)}else{if("function"!=typeof window.univerAPI[e[r].methodName])return console.error(`Method ${r}: ${e[r].methodName} does not exist on Univer API`),console.error(n),{res:!1};n=0==e[r].args.length?window.univerAPI[e[r].methodName]():window.univerAPI[e[r].methodName](...e[r].args)}return t?{res:n}:{res:!0}}function isPromise(e){return e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof e.then}export function getSheetsInfo(){var e=[];return window.univerAPI.getActiveWorkbook().getSheets().forEach((t=>{e.push({id:t.getSheetId(),name:t.getSheetName(),maxUsed:t.getDataRange().getRange(),tabColor:t.getTabColor()})})),e}export function hasFilter(){return!!window.univerAPI.getActiveWorkbook().getActiveSheet().getFilter()}export function getCellsStylesInfo(){var e=[];return window.univerAPI.getActiveWorkbook().getActiveSheet().getActiveRange().getCellStyles().forEach((t=>{var n=[];t.forEach((e=>{if(e){var t=e.getValue();0===Object.keys(t).length?n.push(null):n.push(t)}else n.push(null)})),e.push(n)})),e}export function getAllMerges(){var e=[];return window.univerAPI.getActiveWorkbook().getActiveSheet().getMergedRanges().forEach((t=>{e.push(t.getRange())})),e}export function insertHyperLink(e,t){const n=window.univerAPI.getActiveWorkbook().getActiveSheet().getActiveRange(),r=window.univerAPI.newRichText().insertLink(e,t);n.setRichTextValueForCell(r)}export async function insertComment(e){const t=window.univerAPI.getActiveWorkbook().getActiveSheet().getActiveRange(),n=window.univerAPI.newTheadComment().setContent(window.univerAPI.newRichText().insertText(e.text.dataStream)).setDateTime(new Date(e.dT)).setId(e.id).setPersonId(e.userId);await t.addCommentAsync(n)}export function getAllComments(){const e=window.univerAPI.getActiveWorkbook().getActiveSheet().getComments();var t=[];return e.forEach((e=>{t.push(e.getCommentData())})),t}export function getImagesId(){const e=window.univerAPI.getActiveWorkbook().getActiveSheet().getImages();var t=[];return e.forEach((e=>{t.push(e.getId())})),t}export async function getImageById(e,t){var n=null;return await window.univerAPI.getActiveWorkbook().getActiveSheet().getImageById(e).toBuilder().buildAsync().then((e=>{t||(e.source=""),n=e})),n}export function addConditionalFormat(e){var t=getAndExecuteMethod(e,!0);console.log(t.res),window.univerAPI.getActiveWorkbook().getActiveSheet().addConditionalFormattingRule(t.res)}export function initListenerObject(e){window.listenerNET={},window.listenerNET.net=e,window.listenerNET.listeners=[]}export function addListenerRange(e){window.listenerNET.listeners.push(e)}export function removeListener(e){var t=window.listenerNET.listeners.indexOf(e);t>-1&&window.listenerNET.listeners.splice(t,1)}